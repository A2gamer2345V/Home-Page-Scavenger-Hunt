<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Scavenger Hunt</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700;800&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  background:radial-gradient(circle at top,#1e3c44,#0b1c22 70%);
  font-family:'Inter',sans-serif;
  color:#fff;
}
body.locked {
  height: 100vh;
  overflow: hidden;
}

/* COMMON */
.screen{
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
}
.hidden{display:none}

/* ================= WELCOME ================= */
#welcome{
  text-align:center;
}
.welcome-inner{
  width:100%;
  max-width:520px;
  margin:auto;
  padding:0 12px;
}
.key{
  font-size:56px;
  margin-bottom:18px;
  animation:float 3s ease-in-out infinite;
}
#welcome h1{
  font-size:clamp(30px,7vw,44px);
  font-weight:400;
  line-height:1.25;
  margin:0;
}
#welcome h1 span{
  font-weight:800;
}
.subtitle{
  margin-top:14px;
  font-size:clamp(13px,3.5vw,16px);
  line-height:1.5;
  opacity:.85;
}

/* TABLET */
@media (min-width:768px){
  .welcome-inner{max-width:760px}
  #welcome h1{font-size:48px}
  .subtitle{font-size:17px}
}

/* DESKTOP */
@media (min-width:1200px){
  .welcome-inner{max-width:1000px}
  #welcome h1{font-size:58px}
  .subtitle{
    font-size:18px;
    margin-top:18px;
  }
}

/* LOGIN BUTTON (NEW UI ALLOWED) */
#loginBtn{
  margin-top:28px;
  padding:14px 26px;
  border-radius:999px;
  border:none;
  background:#00ffd5;
  color:#000;
  font-weight:700;
  font-size:16px;
  cursor:pointer;
}
#loginBtn:disabled{
  opacity:.6;
  cursor:not-allowed;
}

/* ================= TERMINAL ================= */
.terminal{
  background:rgba(0,0,0,.85);
  border-radius:16px;
  padding:22px;
  width:100%;
  max-width:640px;
  height:180px;
  overflow-y:auto;
  font-family:monospace;
  font-size:clamp(14px,3vw,17px);
  box-shadow:0 0 30px rgba(0,255,213,.2);
}
.line{margin-bottom:8px}
.cursor{
  display:inline-block;
  width:8px;
  height:16px;
  background:#00ffd5;
  margin-left:4px;
  animation:blink 1s infinite;
}

/* ================= MAIN CONTENT ================= */
#content{
  max-width:1100px;
  margin:auto;
  padding:70px 20px 90px;
}

.hero{
  text-align:center;
  margin-bottom:70px;
}
.hero h1{
  font-size:clamp(36px,7vw,60px);
  font-weight:800;
}

.section{
  margin-bottom:70px;
  opacity:0;
  transform:translateY(30px);
  animation:reveal 1s ease forwards;
}
.section:nth-of-type(1){animation-delay:.6s}
.section:nth-of-type(2){animation-delay:1.2s}
.section:nth-of-type(3){animation-delay:1.8s}

.section-title{
  font-size:22px;
  color:#00ffd5;
  margin-bottom:22px;
}

.glass{
  background:rgba(255,255,255,.06);
  backdrop-filter:blur(10px);
  border-radius:26px;
  padding:34px;
  box-shadow:0 0 30px rgba(0,0,0,.4);
}

/* PRIZES */
.prizes{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:24px;
}
.prize{
  text-align:center;
  padding:30px;
  border-radius:22px;
  background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(0,0,0,.6));
}
.prize span{
  font-size:14px;
  opacity:.85;
}
.gold{border:1px solid #d4af37}
.silver{border:1px solid #c0c0c0}
.bronze{border:1px solid #cd7f32}

/* RULES */
.rules{
  list-style:none;
  padding:0;
  margin:0;
}
.rules li{
  margin-bottom:14px;
  padding-left:20px;
  position:relative;
}
.rules li::before{
  content:"‚Äî";
  position:absolute;
  left:0;
  color:#00ffd5;
}

/* UPDATES */
.updates{
  display:flex;
  flex-direction:column;
  gap:18px;
}
.update{
  padding-left:14px;
  border-left:3px solid #00ffd5;
}
.update-time{
  font-size:12px;
  opacity:.6;
  margin-bottom:4px;
}
/* USERS COUNT */
.player-count{
  position:relative;
  top:16px;
  right:18px;
  background:rgba(0,0,0,.6);
  padding:8px 14px;
  border-radius:20px;
  font-size:14px;
  box-shadow:0 0 12px rgba(0,255,213,.2);
  z-index:999;
}
.player-count{
  display:inline-flex;
  align-items:center;
  gap:8px;
  width:fit-content;
}


/* ================= ANIMATIONS ================= */
@keyframes float{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
}
@keyframes blink{
  0%,50%{opacity:1}
  51%,100%{opacity:0}
}
@keyframes reveal{
  to{opacity:1;transform:none}
}
</style>
</head>

<body>

<!-- WELCOME -->
<div id="welcome" class="screen">
  <div class="welcome-inner">
    <div class="key">üóùÔ∏è</div>
    <h1>Welcome To Scavenger Hunt</h1>
    <div class="subtitle">
      Think. Search. Decode. The hunt begins soon.
    </div>
    <button id="loginBtn">Continue with Google</button>
  </div>
</div>

<!-- TERMINAL -->
<div id="decrypting" class="screen hidden">
  <div class="terminal" id="terminal"></div>
</div>

<!-- MAIN CONTENT -->
<div id="content" class="hidden">
  <div class="player-count">
        üë• NO. of Players: <span id="playerTotal">0</span>
        üë§ Player: <span id="playerName">Guest</span>
  </div>
     

  <div class="hero">
    <h1>Welcome To Scavenger Hunt</h1>
    <h3>Hosted by A2gamer</h3>
  </div>

  <!-- PRIZES -->
  <section class="section">
    <div class="section-title">üèÜ Prize Pool</div>
    <div class="prizes">
      <div class="prize gold">
        <h3>ü•á Winner</h3>
        <p>üéßSpotify Premium</p>
        <span>Free for 3 Months</span>
      </div>
      <div class="prize silver">
        <h3>ü•à Runner Up</h3>
        <p>üé¨YouTube Premium</p>
        <span>Free for 2 Months</span>
      </div>
      <div class="prize bronze">
        <h3>ü•â Third Place</h3>
        <p>üé¨YouTube Premium</p>
        <span>Free for 1 Month</span>
      </div>
    </div>
  </section>

  <!-- RULES -->
  <section class="section">
    <div class="section-title">üìú Rules</div>
    <div class="glass">
      <ul class="rules">
        <li>Each clue leads to the next</li>
        <li>No sharing answers or hints</li>
        <li>No automation or cheating</li>
        <li>Use logic, patience, and creativity</li>
        <li>Organizer‚Äôs decision is final</li>
      </ul>
    </div>
  </section>

  <!-- UPDATES -->
  <section class="section">
    <div class="section-title">üì¢ Updates</div>
    <div class="glass updates" id="updatesBox">
      <div class="update">
        <div class="update-time">Just now</div>
        The hunt is live. Stay alert.
      </div>
      <div class="update">
        <div class="update-time">Soon</div>
        First clue will be released shortly.
      </div>
    </div>
  </section>

</div>
  <script type="module">

    import { initializeApp }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";

import { getDatabase, ref, onValue, get, update }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

import { getAuth, GoogleAuthProvider, signInWithPopup, signOut }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

import { onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";


  document.body.classList.add("locked");

//login
loginBtn.onclick = async () => {
  loginBtn.disabled = true;

  let user;

  try {
    // ‚úÖ AUTH ONLY
    const result = await signInWithPopup(auth, provider);
    user = result.user;

    if (!user) {
      throw new Error("User object missing");
    }

  } catch (authError) {
    console.error("Auth error:", authError);
    alert("Login failed ‚ùå");
    loginBtn.disabled = false;
    return; // ‚õî STOP EVERYTHING
  }

  // ‚¨áÔ∏è FROM HERE: LOGIN IS CONFIRMED SUCCESSFUL ‚¨áÔ∏è

  try {
    const userRef = ref(db, "participants/" + user.uid);
    const snap = await get(userRef);

    if (snap.exists() && snap.val().blocked === true) {
      alert("You are blocked from this event.");
      await signOut(auth);
      loginBtn.disabled = false;
      return; // ‚õî STOP
    }

    await update(userRef, {
      name: user.displayName,
      email: user.email,
      lastLogin: Date.now()
    });
    // üé¨ UI FLOW ONLY AFTER EVERYTHING IS OK
    startCinematicFlow();

  } catch (dbError) {
    console.error("Post-login error:", dbError);
    alert("Something went wrong after login ‚ùå");
    loginBtn.disabled = false;
    return; // ‚õî STOP
  }
};


    const firebaseConfig = {
      apiKey: "AIzaSyDixe-5RIO9kuU2kjRd20dFfsbgpzmXjl4",
      authDomain: "scavenger-hunt-11b9f.firebaseapp.com",
      databaseURL: "https://scavenger-hunt-11b9f-default-rtdb.firebaseio.com",
      projectId: "scavenger-hunt-11b9f",
      storageBucket: "scavenger-hunt-11b9f.firebasestorage.app",
      messagingSenderId: "678881921446",
      appId: "1:678881921446:web:17378cae12222c5103a767"
    };
   
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    /* USERS COUNT */
  onValue(ref(db,"participants"), snap => {
  const el = document.getElementById("playerTotal");
  if(!el) return;

  // Count all participants
  el.textContent = snap.exists() ? Object.keys(snap.val()).length : 0;
});

   /*PLayer Name*/
    onAuthStateChanged(auth, async (user) => {
  if (!user) return;

  const nameEl = document.getElementById("playerName");
  if (!nameEl) return;

  const snap = await get(ref(db, "participants/" + user.uid));
  if (snap.exists()) {
    nameEl.textContent = snap.val().name;
  }
});

    /* UPDATES */
    onValue(ref(db,"updates"), snap=>{
      const box = document.getElementById("updatesBox");
      if(!box) return;
      box.innerHTML = "";
      snap.forEach(child=>{
        const d = child.val();
        box.innerHTML += `
          <div class="update">
            <div class="update-time">${d.time || ""}</div>
            ${d.text || ""}
          </div>`;
      });
    });

    
    </script>
<script defer>
const loginBtn = document.getElementById("loginBtn");
const welcome = document.getElementById("welcome");
const decrypting = document.getElementById("decrypting");
const terminal = document.getElementById("terminal");
const content = document.getElementById("content");

const lines = [
  "Connecting to server...",
  "Establishing secure channel...",
  "Syncing data...",
  "Connection established.‚úÖ"
];

function startCinematicFlow() {
  welcome.classList.add("hidden");
  decrypting.classList.remove("hidden");
  terminal.innerHTML = "";

  let index = 0;

  function typeLine() {
    if (index >= lines.length) {
      setTimeout(() => {
        decrypting.classList.add("hidden");
        content.classList.remove("hidden");
      }, 0);
      document.body.classList.remove("locked");
      return;
    }

    const line = document.createElement("div");
    line.className = "line";
    terminal.appendChild(line);

    let char = 0;

    function typeChar() {
      if (char < lines[index].length) {
        line.textContent += lines[index][char++];
        terminal.scrollTop = terminal.scrollHeight;
        setTimeout(typeChar, 35);
      } else {
        index++;
        setTimeout(typeLine, 500);
      }
    }

    typeChar(); // ‚úÖ CALLED WHERE IT EXISTS
  }

  typeLine(); // ‚úÖ STARTS THE FLOW
}

/* FLOW */
setTimeout(()=>{
  decrypting.classList.add("hidden");
  content.classList.remove("hidden");
},60000);
</script>
</html>
